<html>
<script src="blockly_compressed.js"></script>
<script src="blocks_compressed.js"></script>
<script src="javascript_compressed.js"></script>
<script src="msg/js/en.js"></script>

<script src="custom/change_x/change_x_prem.js"></script>
<script src="custom/change_y/change_y_prem.js"></script>

<script>


    Blockly.Blocks['draw_circle'] = {
        init: function () {
            this.setColour(160);
            this.appendDummyInput()
                .appendField(new Blockly.FieldAngle('90'), 'ANGLE');
            this.setPreviousStatement(true);
            this.setTooltip('Draws a Circle');
         
        }
    };
</script>

<div class="button-div">
    <button class="button" onclick="runCode()">Execute</button>
</div>

<canvas id="circle" width="150" height="150"></canvas>

<div id="blockly-div" style="height: 480px; width: 600px;"></div>
<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
    <category name="Balaji-Blocks" colour="#995ba5">
        <block type="controls_repeat_ext">
            <value name="TIMES">
                <block type="math_number">
                    <field name="NUM">10</field>
                </block>
            </value>
        </block>
        <block type="text"></block>
        <block type="text_print"></block>
        <block type="draw_circle"></block>
        <block type="change_x"></block>
        <block type="change_y"></block>
    </category>
</xml>
<script>
    count2 = 10;
    var workspace = Blockly.inject('blockly-div',
        { toolbox: document.getElementById('toolbox') });



    Blockly.JavaScript['draw_circle'] = function (block) {
        return 'drawCircle();\n';
    }

   

    function drawCircle() {
        var canvas = document.getElementById('circle');
        if (canvas.getContext) {
            var ctx = canvas.getContext('2d');
            var X = (canvas.width) / 2;
            var Y = (canvas.height) / 2;
            var R = 45;
            ctx.beginPath();
            ctx.arc(X+count2, Y, R, 0, 2 * Math.PI, false);
            ctx.lineWidth = 3;
            ctx.strokeStyle = '#FF0000';
            ctx.stroke();
            console.log(count2++);
            
        }
    }

    function runCode() {
        const code = Blockly.JavaScript.workspaceToCode(workspace);
        console.log(code);
        eval(code);

        // return code;
    }


</script>

</html>